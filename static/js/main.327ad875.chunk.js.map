{"version":3,"sources":["assets/images/avataaars.svg","api/api.js","redux/dialog-reducer.ts","components/Navbar/Navbar.module.css","components/Navbar/Navbar.jsx","components/News/News.jsx","components/Music/Music.jsx","components/Setings/Setings.jsx","utils/object-helpers.js","redux/users-reducer.ts","components/common/Paginator/Paginator.tsx","components/Users/User.jsx","components/Users/Users.tsx","redux/users-selectors.ts","components/Users/UsersContainer.tsx","redux/auth-reducer.ts","components/Login/Login.jsx","components/Header/Header.jsx","components/Header/HeaderContainer.jsx","redux/app-reducer.ts","App.js","reportWebVitals.js","redux/sidebar-reducer.ts","redux/redux-store.ts","index.tsx","components/Users/Users.module.css","components/common/Paginator/Paginator.module.css","components/common/FormsControls/FormsControls.module.css","components/common/FormsControls/FormsControls.jsx","assets/images/preloader.svg","components/common/preloader/Preloader.jsx","utils/validators/validators.js","components/News/News.module.css","components/Music/Music.module.css","components/Setings/Setings.module.css","components/Login/Login.module.css","components/Header/Header.module.css","redux/profile-reducer.ts"],"names":["instance","axios","create","withCredentials","headers","baseURL","usersAPI","getUsers","currentPage","pageSize","get","then","response","data","unfollow","userId","delete","follow","post","profileAPI","getProfile","getStatus","updateStatus","status","put","savePhoto","photoFile","formData","FormData","append","saveProfile","profile","authAPI","me","login","email","password","rememberMe","captcha","logout","securityAPI","getCaptchaUrl","ADD_MESSAGE","stateDialogs","dialogs","id","name","messages","message","addMessage","type","dialogsReducer","state","action","module","exports","Navbar","className","styles","nav","item","to","activeClassName","activeLink","News","wrapper","wrapper__item","Music","Setings","updateObjectInArray","items","itemId","objPropName","newObjProps","map","user","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","totalUsersCount","isFetching","followingInProgress","followSuccess","unfollowSuccess","toggleIsFetching","toggleFollowingProgress","followUnfollowFlow","dispatch","apiMethod","actionCreator","a","resultCode","usersReducer","followed","filter","Paginator","totalItemsCount","onPageChanged","portionSize","pagesCount","Math","ceil","portionCount","useState","portionNumber","setPortionNumber","leftPortionPageNumber","rightPortionPageNumber","pages","i","push","paginationBlockWrapper","paginationBlock","buttonPrev","onClick","disabled","page","event","pagination","selectedPage","buttonNext","User","userPhoto","src","photos","small","avataaars","alt","userButton","some","Users","createSelector","usersPage","u","getPageSize","getTotalUsersCount","getCurrentPage","getIsFetching","getFollowingInProgress","UsersContainer","props","requestUsers","this","pageTitle","Preloader","React","Component","compose","connect","bind","totalCount","SET_USER_DATA","SET_CAPTCHA_URL_SUCCESS","isAuth","captchaUrl","setAuthUserData","payload","getAuthUserData","url","authReducer","LoginReduxForm","reduxForm","form","handleSubmit","error","onSubmit","loginFormWrapper","Field","placeholder","component","Input","validate","required","formSummaryError","auth","length","stopSubmit","_error","stylesLogin","loginH1","loginblock","Header","header","HeaderContainer","INITIALIZED_SUCCESS","initialized","appReducer","DialogsContainer","lazy","ProfileContainer","App","catchAllUnhandledErrors","reason","promise","console","log","initializeApp","window","addEventListener","removeEventListener","fallback","path","exact","withRouter","app","Promise","all","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","sidebarReducer","rootReducer","combineReducers","profilePage","profileReducer","dialogsPage","sidebar","formReducer","store","createStore","composeWithDevTools","applyMiddleware","thunk","ReactDOM","render","document","getElementById","FormControl","input","meta","child","hasError","touched","formControl","children","Textarea","restProps","preloader","value","maxLengthCreator","maxLength","ADD_POST","SET_USERS_PROFILE","SET_STATUS","SAVE_PHOTO_SUCCESS","DELETE_POST","posts","likeCounter","newPostText","addPostActionCreator","setStatus","getUserProfile","file","getState","reject","p","postId"],"mappings":"oIAAe,QAA0B,uC,6MCEnCA,E,OAAWC,EAAMC,OAAO,CAC5BC,iBAAiB,EACjBC,QAAS,CAAE,UAAW,wCACtBC,QAAS,kDAGEC,EAAW,CACtBC,SADsB,SACbC,EAAaC,GACpB,OAAOT,EACJU,IADI,qBACcF,EADd,kBACmCC,IACvCE,MAAK,SAACC,GAAD,OAAcA,EAASC,SAE3BC,SANgB,SAMPC,GAAS,OAAD,0HACEf,EAASgB,OAAT,iBAA0BD,IAD5B,cACfH,EADe,yBAEdA,EAASC,MAFK,8CAIjBI,OAVgB,SAUTF,GAAS,OAAD,0HACIf,EAASkB,KAAT,iBAAwBH,IAD5B,cACbH,EADa,yBAEZA,EAASC,MAFG,+CAUVM,EAAa,CAClBC,WADkB,SACPL,GAAS,OAAD,0HACAf,EAASU,IAAT,kBAAwBK,IADxB,cACjBH,EADiB,yBAEhBA,EAASC,MAFO,8CAInBQ,UALkB,SAKRN,GAAS,OAAD,0HACCf,EAASU,IAAT,yBAA+BK,IADhC,cAChBH,EADgB,yBAEfA,EAASC,MAFM,8CAIlBS,aATkB,SASLC,GAAS,OAAD,0HACFvB,EAASwB,IAAT,iBAA+B,CAAED,OAAQA,IADvC,cACnBX,EADmB,yBAElBA,EAASC,MAFS,8CAIrBY,UAbkB,SAaRC,GAAY,OAAD,mHACnBC,EAAW,IAAIC,UACZC,OAAO,QAASH,GAFA,SAGF1B,EAASwB,IAAT,gBAA8BG,EAAU,CAC7DvB,QAAS,CACP,eAAgB,yBALK,cAGnBQ,EAHmB,yBAQlBA,EAASC,MARS,8CAUrBiB,YAvBkB,SAuBNC,GAAU,OAAD,0HACF/B,EAASwB,IAAT,UAAwBO,GADtB,cACnBnB,EADmB,yBAElBA,EAASC,MAFS,+CAMhBmB,EAAU,CACfC,GADe,WACT,OAAD,0HACcjC,EAASU,IAAT,WADd,cACHE,EADG,yBAEFA,EAASC,MAFP,8CAILqB,MALe,SAKTC,EAAOC,GAA+C,IAAD,wIAApCC,EAAoC,gCAAhBC,EAAgB,+BAAN,KAAM,SACxCtC,EAASkB,KAAT,aAA4B,CACjDiB,MAAOA,EACPC,SAAUA,EACVC,WAAYA,EACZC,QAASA,IALoD,cACzD1B,EADyD,yBAOxDA,EAASC,MAP+C,8CAS3D0B,OAde,WAcL,OAAD,0HACUvC,EAASgB,OAAT,cADV,cACPJ,EADO,yBAENA,EAASC,MAFH,+CAgBJ2B,EAAc,CACnBC,cADmB,WACF,OAAD,0HACGzC,EAASU,IAAT,4BADH,cACdE,EADc,yBAEbA,EAASC,MAFI,gD,sFCxFlB6B,EAAc,oCAkBdC,EAAiC,CACrCC,QAAS,CACP,CACEC,GAAI,EACJC,KAAM,UAER,CACED,GAAI,EACJC,KAAM,UAER,CACED,GAAI,EACJC,KAAM,SAER,CAAED,GAAI,EAAGC,KAAM,SACf,CAAED,GAAI,EAAGC,KAAM,UACf,CAAED,GAAI,EAAGC,KAAM,WAEjBC,SAAU,CACR,CAAEF,GAAI,EAAGG,QAAS,MAClB,CAAEH,GAAI,EAAGG,QAAS,mBAClB,CAAEH,GAAI,EAAGG,QAAS,eAsBTC,EAAa,SAACD,GAAD,MAA4C,CAAEE,KAAMR,EAAaM,YAE5EG,IApBQ,WAA6F,IAA5FC,EAA2F,uDAAjET,EAAcU,EAAmD,uCACjH,OAAQA,EAAOH,OACRR,EACI,2BACFU,GADL,IAEEL,SAAS,GAAD,mBAAMK,EAAML,UAAZ,CAAsB,CAAEF,GAAI,EAAGG,QAASK,EAAOL,aAGlDI,I,+DClDbE,EAAOC,QAAU,CAAC,IAAM,oBAAoB,KAAO,qBAAqB,WAAa,6B,+JC6CtEC,EA1CA,WAKb,OACE,sBAAKC,UAAWC,IAAOC,IAAvB,UACE,qBAAKF,UAAWC,IAAOE,KAAvB,SACE,cAAC,IAAD,CAASC,GAAG,WAAWC,gBAAiBJ,IAAOK,WAA/C,uBAIF,qBAAKN,UAAWC,IAAOE,KAAvB,SACE,cAAC,IAAD,CAASC,GAAG,WAAWC,gBAAiBJ,IAAOK,WAA/C,wBAIF,qBAAKN,UAAWC,IAAOE,KAAvB,SACE,cAAC,IAAD,CAASC,GAAG,QAAQC,gBAAiBJ,IAAOK,WAA5C,oBAIF,qBAAKN,UAAWC,IAAOE,KAAvB,SACE,cAAC,IAAD,CAASC,GAAG,SAASC,gBAAiBJ,IAAOK,WAA7C,qBAIF,qBAAKN,UAAWC,IAAOE,KAAvB,SACE,cAAC,IAAD,CAASC,GAAG,SAASC,gBAAiBJ,IAAOK,WAA7C,qBAKF,qBAAKN,UAAWC,IAAOE,KAAvB,SACE,cAAC,IAAD,CAASC,GAAG,WAAWC,gBAAiBJ,IAAOK,WAA/C,4B,iBCtBOC,EAdF,kBACX,gCACE,qCACA,sBAAKP,UAAWC,IAAOO,QAAvB,UACE,qBAAKR,UAAWC,IAAOQ,cAAvB,qBAGA,qBAAKT,UAAWC,IAAOQ,cAAvB,4B,iBCOSC,EAdD,kBACZ,gCACE,sCACA,sBAAKV,UAAWC,IAAOO,QAAvB,UACE,qBAAKR,UAAWC,IAAOQ,cAAvB,uBAGA,qBAAKT,UAAWC,IAAOQ,cAAvB,8B,iBCOSE,EAdC,kBACd,gCACE,wCACA,sBAAKX,UAAWC,IAAOO,QAAvB,UACE,qBAAKR,UAAWC,IAAOQ,cAAvB,mCAGA,qBAAKT,UAAWC,IAAOQ,cAAvB,0C,uDCTOG,EAAsB,SAACC,EAAOC,EAAQC,EAAaC,GAC9D,OAAOH,EAAMI,KAAI,SAACC,GAChB,OAAIA,EAAKH,KAAiBD,EACjB,2BAAKI,GAASF,GAEhBE,MCDLC,EAAS,8BACTC,EAAW,gCACXC,EAAY,iCACZC,EAAmB,wCACnBC,EAAwB,6CACxBC,EAAqB,0CACrBC,EAA+B,oDAiBjCC,EAAe,CACjBC,MAAO,GACP3E,SAAU,GACV4E,gBAAiB,EACjB7E,YAAa,EACb8E,YAAY,EACZC,oBAAqB,IAkHVC,EAAgB,SAACzE,GAAD,MAAqD,CAAEmC,KAAM0B,EAAQ7D,WACrF0E,EAAkB,SAAC1E,GAAD,MAAuD,CAAEmC,KAAM2B,EAAU9D,WAW3F2E,EAAmB,SAACJ,GAAD,MAAsD,CACpFpC,KAAM+B,EACNK,eAEWK,EAA0B,SAACL,EAAqBvE,GAAtB,MAAoF,CACzHmC,KAAMgC,EACNI,aACAvE,WA4BW6E,EAAkB,uCAAG,WAAOC,EAAe9E,EAAuB+E,EAAgBC,GAA7D,SAAAC,EAAA,6DAChCH,EAASF,GAAwB,EAAM5E,IADP,SAEb+E,EAAU/E,GAFG,OAGR,IAHQ,OAGvBkF,YACPJ,EAASE,EAAchF,IAEzB8E,EAASF,GAAwB,EAAO5E,IANR,2CAAH,4DAmChBmF,EA/LM,WAA4Q,IAA3Q9C,EAA0Q,uDAAhP+B,EAAc9B,EAAkO,uCAC9R,OAAQA,EAAOH,MAGb,KAAK0B,EACH,OAAO,2BACFxB,GADL,IAEEgC,MAAOf,EAAoBjB,EAAMgC,MAAO/B,EAAOtC,OAAQ,KAAM,CAAEoF,UAAU,MAE7E,KAAKtB,EACH,OAAO,2BACFzB,GADL,IAEEgC,MAAOf,EAAoBjB,EAAMgC,MAAO/B,EAAOtC,OAAQ,KAAM,CAAEoF,UAAU,MAyB7E,KAAKrB,EACH,OAAO,2BACF1B,GADL,IAEEgC,MAAO/B,EAAO+B,QAIlB,KAAKL,EACH,OAAO,2BACF3B,GADL,IAEE5C,YAAa6C,EAAO7C,cAGxB,KAAKwE,EACH,OAAO,2BACF5B,GADL,IAEEiC,gBAAiBhC,EAAOgC,kBAG5B,KAAKJ,EACH,OAAO,2BACF7B,GADL,IAEEkC,WAAYjC,EAAOiC,aAGvB,KAAKJ,EACH,OAAO,2BACF9B,GADL,IAEEmC,oBAAqBlC,EAAOiC,WAAP,sBACblC,EAAMmC,qBADO,CACclC,EAAOtC,SACtCqC,EAAMmC,oBAAoBa,QAAO,SAACvD,GAAD,OAAQA,IAAOQ,EAAOtC,YAG/D,QACE,OAAOqC,I,2CCzCEiD,EAzDwB,SAAC,GAStC,IATuH,IAA/EC,EAA8E,EAA9EA,gBAAiB7F,EAA6D,EAA7DA,SAAU8F,EAAmD,EAAnDA,cAAe/F,EAAoC,EAApCA,YAAoC,IAAvBgG,mBAAuB,MAAT,GAAS,EAChHC,EAAaC,KAAKC,KAAKL,EAAkB7F,GACzCmG,EAAeF,KAAKC,KAAKF,EAAaD,GAC5C,EAA0CK,mBAAiBH,KAAKC,KAAKnG,EAAcgG,IAAnF,mBAAOM,EAAP,KAAsBC,EAAtB,KAEMC,GAAyBF,EAAgB,GAAKN,EAAc,EAC5DS,EAAyBH,EAAgBN,EACzCU,EAAkB,GAEfC,EAAI,EAAGA,GAAKV,EAAYU,IAAKD,EAAME,KAAKD,GAEjD,OACE,qBAAK1D,UAAWC,IAAO2D,uBAAvB,SACE,sBAAK5D,UAAWC,IAAO4D,gBAAvB,UACGR,EAAgB,EACf,wBACErD,UAAWC,IAAO6D,WAClBC,QAAS,WACPT,EAAiBD,EAAgB,IAHrC,kBAQA,wBAAQW,UAAU,EAAlB,kBAEDP,EACEd,QAAO,SAACsB,GAAD,OAAUA,GAAQV,GAAyBU,GAAQT,KAC1DvC,KAAI,SAACgD,EAAM7E,GACV,OACE,sBAEE2E,QAAS,SAACG,GACRpB,EAAcmB,IAEhBjE,UAAS,UAAKC,IAAOkE,WAAZ,YACPpH,IAAgBkH,EAAOhE,IAAOmE,aAAe,IANjD,SAQGH,GAPI7E,MAWZiE,EAAgBF,EACf,wBACEnD,UAAWC,IAAOoE,WAClBN,QAAS,WACPT,EAAiBD,EAAgB,IAHrC,kBAQA,wBAAQW,UAAU,EAAlB,wB,SCVKM,GA/CF,SAAC,GAAqD,IAAnDxC,EAAkD,EAAlDA,oBAAqBtE,EAA6B,EAA7BA,OAAQH,EAAqB,EAArBA,SAAU6D,EAAW,EAAXA,KACrD,OACE,gCACE,gCACE,8BACE,cAAC,IAAD,CAASd,GAAI,YAAcc,EAAK9B,GAAhC,SACE,qBACEY,UAAWC,IAAOsE,UAClBC,IAA0B,MAArBtD,EAAKuD,OAAOC,MAAgBxD,EAAKuD,OAAOC,MAAQC,IACrDC,IAAI,eAIV,qBAAK5E,UAAWC,IAAO4E,WAAvB,SACG3D,EAAKwB,SACJ,wBACEsB,SAAUlC,EAAoBgD,MAAK,SAAC1F,GAAD,OAAQA,IAAO8B,EAAK9B,MACvD2E,QAAS,WACP1G,EAAS6D,EAAK9B,KAHlB,sBAQA,wBACE4E,SAAUlC,EAAoBgD,MAAK,SAAC1F,GAAD,OAAQA,IAAO8B,EAAK9B,MACvD2E,QAAS,WACPvG,EAAO0D,EAAK9B,KAHhB,yBAUN,sBAAKY,UAAWC,IAAOQ,cAAvB,UACE,gCACE,8BAAMS,EAAK7B,OACX,8BAAM6B,EAAKpD,YAEb,+BCQOiH,GAhCoB,SAAC,GAS7B,IARLnD,EAQI,EARJA,gBACA5E,EAOI,EAPJA,SACA8F,EAMI,EANJA,cACA/F,EAKI,EALJA,YACA4E,EAII,EAJJA,MACAG,EAGI,EAHJA,oBACAtE,EAEI,EAFJA,OACAH,EACI,EADJA,SAEA,OACE,gCACE,cAAC,EAAD,CACEwF,gBAAiBjB,EACjB5E,SAAUA,EACV8F,cAAeA,EACf/F,YAAaA,IAEd4E,EAAMV,KAAI,SAACC,GAAD,OACT,qBAAKlB,UAAWC,IAAOO,QAAvB,SACE,cAAC,GAAD,CACEsB,oBAAqBA,EACrBtE,OAAQA,EACRH,SAAUA,EACV6D,KAAMA,KAL2BA,EAAK9B,W,4BC9BrCtC,GAAWkI,cAHC,SAACrF,GACxB,OAAOA,EAAMsF,UAAUtD,SAEgC,SAACA,GACxD,OAAOA,EAAMgB,QAAO,SAACuC,GAAD,OAAO,QAGhBC,GAAc,SAACxF,GAC1B,OAAOA,EAAMsF,UAAUjI,UAEZoI,GAAqB,SAACzF,GACjC,OAAOA,EAAMsF,UAAUrD,iBAEZyD,GAAiB,SAAC1F,GAC7B,OAAOA,EAAMsF,UAAUlI,aAEZuI,GAAgB,SAAC3F,GAC5B,OAAOA,EAAMsF,UAAUpD,YAEZ0D,GAAyB,SAAC5F,GACrC,OAAOA,EAAMsF,UAAUnD,qBCsCnB0D,G,4MAOJ1C,cAAgB,SAAC/F,GACf,EAAK0I,MAAMC,aAAa3I,EAAa,EAAK0I,MAAMzI,W,uDANlD,WACE,MAAgC2I,KAAKF,MAA9B1I,EAAP,EAAOA,YAAaC,EAApB,EAAoBA,SACpB2I,KAAKF,MAAMC,aAAa3I,EAAaC,K,oBAOvC,WACE,OACE,qCACE,6BAAK2I,KAAKF,MAAMG,YACfD,KAAKF,MAAM5D,WACV,cAACgE,GAAA,EAAD,IACE,KACJ,cAAC,GAAD,CACEjE,gBAAiB+D,KAAKF,MAAM7D,gBAC5B5E,SAAU2I,KAAKF,MAAMzI,SACrBD,YAAa4I,KAAKF,MAAM1I,YACxB4E,MAAOgE,KAAKF,MAAM9D,MAClBmB,cAAe6C,KAAK7C,cACpBtF,OAAQmI,KAAKF,MAAMjI,OACnBH,SAAUsI,KAAKF,MAAMpI,SACrByE,oBAAqB6D,KAAKF,MAAM3D,6B,GA1BbgE,IAAMC,WA6CpBC,sBACbC,aAboB,SAACtG,GAErB,MAAO,CACLgC,MAAO7E,GAAS6C,GAChB3C,SAAUmI,GAAYxF,GACtBiC,gBAAiBwD,GAAmBzF,GACpC5C,YAAasI,GAAe1F,GAC5BkC,WAAYyD,GAAc3F,GAC1BmC,oBAAqByD,GAAuB5F,MAKgD,CAC5FnC,OL8FkB,SAACF,GAAD,8CAA2B,WAAO8E,GAAP,SAAAG,EAAA,sDAG/CJ,EAAmBC,EAAU9E,EAAQT,IAASW,OAAO0I,KAAKrJ,KAAWkF,GAHtB,2CAA3B,uDK7FlB1E,SL0GoB,SAACC,GAAD,8CAA2B,WAAO8E,GAAP,SAAAG,EAAA,sDAGjDJ,EAAmBC,EAAU9E,EAAQT,IAASQ,SAAS6I,KAAKrJ,KAAWmF,GAHtB,2CAA3B,uDKzGpB0D,aL4DwB,SAACzB,EAAcjH,GAAf,8CAA2C,WAAOoF,GAAP,eAAAG,EAAA,6DACrEH,EAtBgF,CAAE3C,KAAM6B,EAAkBvE,YAsBlFkH,IACxB7B,EAASH,GAAiB,IAF2C,SAGlDpF,IAASC,SAASmH,EAAMjH,GAH0B,OAG/DI,EAH+D,OAIrEgF,EAASH,GAAiB,IAC1BG,GA3BuBT,EA2BLvE,EAAKyD,MA3BiD,CAAEpB,KAAM4B,EAAWM,WA4B3FS,GA1BiCR,EA0BLxE,EAAK+I,WA1B2D,CAC5F1G,KAAM8B,EACNK,qBAkBqE,iCApBrC,IAACA,EAFVD,IAsB8C,OAA3C,yDKhEbqE,CAQbR,I,+CCjHIY,GAAgB,oCAEhBC,GAA0B,8CAU5B3E,GAAiC,CACnCpE,OAAQ,KACRoB,MAAO,KACPD,MAAO,KACP6H,QAAQ,EACRC,WAAY,MAmDDC,GAAkB,SAAClJ,EAAuBoB,EAAsBD,EAAsB6H,GAApE,IAAqFC,EAArF,uDAAiH,KAAjH,MAAsJ,CACnL9G,KAAM2G,GACNK,QAAS,CAAEnJ,SAAQoB,QAAOD,QAAO6H,SAAQC,gBAU9BG,GAAkB,yDAAM,WAAOtE,GAAP,uBAAAG,EAAA,sEAChBhE,IAAQC,KADQ,OAEX,KADlBpB,EAD6B,QAE1BoF,aAAmB,EACCpF,EAAKA,KAA1BgC,EADmB,EACnBA,GAAIV,EADe,EACfA,MAAOD,EADQ,EACRA,MACjB2D,EAASoE,GAAgBpH,EAAIV,EAAOD,GAAO,KAJV,2CAAN,uDA8BlBO,GAAgB,yDAAM,WAAOoD,GAAP,eAAAG,EAAA,sEACdxD,IAAYC,gBADE,OAC3B5B,EAD2B,OAEjCgF,GAvCmCmE,EAuCLnJ,EAAKuJ,IAvC+D,CAClGlH,KAAM4G,GACNE,gBAmCiC,iCArCC,IAACA,IAqCF,OAAN,uDAcdK,GA9FK,WAAmI,IAAlIjH,EAAiI,uDAAvG+B,GAAc9B,EAAyF,uCACpJ,OAAQA,EAAOH,MACb,KAAK2G,GACH,OAAO,2BACFzG,GACAC,EAAO6G,SAQd,KAAKJ,GACH,OAAO,2BACF1G,GADL,IAEE4G,WAAY3G,EAAO2G,aAGvB,QACE,OAAO5G,I,iDCJPkH,GAAiBC,aAAU,CAAEC,KAAM,SAAlBD,EAvCL,SAAC,GAAyC,IAAvCE,EAAsC,EAAtCA,aAAcC,EAAwB,EAAxBA,MAAOV,EAAiB,EAAjBA,WACxC,OACE,uBAAMW,SAAUF,EAAchH,UAAWC,KAAOkH,iBAAhD,UACE,8BACE,cAACC,GAAA,EAAD,CAAOC,YAAa,QAAShI,KAAM,QAASiI,UAAWC,KAAOC,SAAU,CAACC,UAE3E,8BACE,cAACL,GAAA,EAAD,CACEC,YAAa,WACbhI,KAAM,WACNI,KAAM,WACN6H,UAAWC,KACXC,SAAU,CAACC,UAGf,8BACE,cAACL,GAAA,EAAD,CAAOE,UAAWC,KAAOlI,KAAM,aAAcI,KAAM,eAEpDwH,GAAS,qBAAKjH,UAAWC,KAAOyH,iBAAvB,SAA0CT,IACnDV,GACC,gCACE,qBAAK/B,IAAK+B,EAAY3B,IAAI,YAC1B,cAACwC,GAAA,EAAD,CAAOC,YAAa,UAAWhI,KAAM,UAAWiI,UAAWC,KAAOC,SAAU,CAACC,WAGjF,8BACE,mDA0COxB,gBALS,SAACtG,GAAD,MAAY,CAClC2G,OAAQ3G,EAAMgI,KAAKrB,OACnBC,WAAY5G,EAAMgI,KAAKpB,cAGe,CAAE9H,MDcrB,SAACC,EAAeC,EAAkBC,EAAqBC,GAAvD,8CAAwE,WAAOuD,GAAP,iBAAAG,EAAA,sEACxEhE,IAAQE,MAAMC,EAAOC,EAAUC,EAAYC,GAD6B,OAEnE,KADlBzB,EADqF,QAElFoF,WACPJ,EAASsE,OAEe,KAApBtJ,EAAKoF,YACPJ,EAASpD,MAGPO,EAAUnC,EAAKkC,SAASsI,OAAS,EAAIxK,EAAKkC,SAAS,GAAK,aAC5D8C,EAASyF,aAAW,QAAS,CAAEC,OAAQvI,MAVkD,2CAAxE,wDCdN0G,EA3BD,SAACR,GAKb,OAAIA,EAAMa,OACD,cAAC,KAAD,CAAUlG,GAAI,aAIrB,gCACE,oBAAIJ,UAAW+H,KAAYC,QAA3B,mBACA,cAACnB,GAAD,CAAgBK,SAXH,SAAChJ,GAChBuH,EAAMhH,MAAMP,EAASQ,MAAOR,EAASS,SAAUT,EAASU,WAAYV,EAASW,UAUvC0H,WAAYd,EAAMc,aACtD,sBAAKvG,UAAW+H,KAAYE,WAA5B,UACE,+KACA,0DACA,wD,oBCvCOC,GAxBA,SAACzC,GACd,OACE,yBAAQzF,UAAWC,KAAOkI,OAA1B,UACE,wBAQA,qBAAKnI,UAAWC,KAAOxB,MAAvB,SACGgH,EAAMa,OACL,gCACGb,EAAMhH,MADT,IACgB,wBAAQsF,QAAS0B,EAAM3G,OAAvB,wBAGhB,cAAC,IAAD,CAASsB,GAAI,UAAb,yBCfJgI,G,4JAIJ,WACE,OAAO,cAAC,GAAD,eAAYzC,KAAKF,Y,GALEK,IAAMC,WAcrBE,gBALO,SAACtG,GAAD,MAAY,CAChClB,MAAOkB,EAAMgI,KAAKlJ,MAClB6H,OAAQ3G,EAAMgI,KAAKrB,UAGmB,CAAExH,OHsFpB,yDAAM,WAAOsD,GAAP,SAAAG,EAAA,sEACPhE,IAAQO,SADD,OAEF,IAFE,OAEjB0D,YACPJ,EAASoE,GAAgB,KAAM,KAAM,MAAM,IAHnB,2CAAN,wDGtFPP,CAAqCmC,IClB9CC,GAAsB,sBAMtB3G,GAAiC,CACrC4G,aAAa,GAkCAC,GA/BI,WAAqG,IAApG5I,EAAmG,uDAAzE+B,GAAc9B,EAA2D,uCACrH,OAAQA,EAAOH,OACR4I,GACI,2BACF1I,GADL,IAEE2I,aAAa,IAIR3I,GCFP6I,GAAmB1C,IAAM2C,MAAK,kBAAM,iCACpCC,GAAmB5C,IAAM2C,MAAK,kBAAM,iCAGpCE,G,4MACJC,wBAA0B,SAACC,EAAQC,GACjCC,QAAQC,IAAI,uB,uDAId,WACErD,KAAKF,MAAMwD,gBACXC,OAAOC,iBAAiB,qBAAsBxD,KAAKiD,2B,kCAGrD,WACEM,OAAOE,oBAAoB,qBAAsBzD,KAAKiD,2B,oBAGxD,WACE,OAAKjD,KAAKF,MAAM6C,YAId,sBAAKtI,UAAU,cAAf,UACE,cAAC,GAAD,IACA,cAAC,EAAD,IACA,sBAAKA,UAAU,sBAAf,UACE,eAAC,WAAD,CAAUqJ,SAAU,cAACxD,GAAA,EAAD,IAApB,UACE,cAAC,KAAD,CAAOyD,KAAK,oBAAZ,SACE,cAACZ,GAAD,MAIF,cAAC,KAAD,CAAOY,KAAK,WAAZ,SACE,cAACd,GAAD,SAGJ,cAAC,KAAD,CAAOc,KAAK,SAAZ,SACE,cAAC,GAAD,MAEF,cAAC,KAAD,CAAOA,KAAK,SAAZ,SACE,cAAC,GAAD,CAAgB1D,UAAW,iDAE7B,cAAC,KAAD,CAAO0D,KAAK,QAAZ,SACE,cAAC,EAAD,MAEF,cAAC,KAAD,CAAOA,KAAK,SAAZ,SACE,cAAC,EAAD,MAEF,cAAC,KAAD,CAAOA,KAAK,WAAZ,SACE,cAAC,EAAD,MAKF,cAAC,KAAD,CAAOC,OAAK,EAACD,KAAK,IAAlB,SACG3D,KAAKF,MAAM6C,YAAc,cAAC,KAAD,CAAUlI,GAAG,aAAgB,cAAC,GAAD,YApCtD,cAACyF,GAAA,EAAD,Q,GAjBKC,IAAMC,WAiETyD,gBAAWvD,aAJJ,SAACtG,GAAD,MAAY,CAChC2I,YAAa3I,EAAM8J,IAAInB,eAG0B,CAAEW,cDrDxB,kBAAM,SAAC7G,GAClC,IAAI0G,EAAU1G,EAASsE,MAIvBgD,QAAQC,IAAI,CAACb,IAAU5L,MAAK,kBAAMkF,EAVmC,CACrE3C,KAAM4I,WCyDkBpC,CAA4C0C,KC3EvDiB,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqB5M,MAAK,YAAkD,IAA/C6M,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,O,6BCPVnI,GAAe,GAQJ0I,GAJQ,WAA4E,IAA3EzK,EAA0E,uDAAhD+B,GAChD,OAAO/B,G,oBCOH0K,GAAcC,2BAAgB,CAClCC,YAAaC,KACbC,YAAa/K,KACbgL,QAASN,GACTnF,UAAWxC,EACXkF,KAAMf,GACNG,KAAM4D,KACNlB,IAAKlB,KAcQqC,GAFDC,uBAAYR,GAAaS,+BAAoBC,2BAAgBC,QCrB3EC,IAASC,OAEP,cAAC,IAAD,UAEE,cAAC,IAAD,CAAUN,MAAOA,GAAjB,SACE,cAAC,GAAD,QAIJO,SAASC,eAAe,SAM1BxB,M,mBCxBA/J,EAAOC,QAAU,CAAC,QAAU,uBAAuB,cAAgB,6BAA6B,UAAY,yBAAyB,WAAa,0BAA0B,WAAa,0BAA0B,aAAe,4BAA4B,UAAY,2B,mBCA1QD,EAAOC,QAAU,CAAC,uBAAyB,0CAA0C,gBAAkB,mCAAmC,WAAa,8BAA8B,aAAe,gCAAgC,WAAa,8BAA8B,WAAa,gC,mBCA5RD,EAAOC,QAAU,CAAC,iBAAmB,wCAAwC,YAAc,mCAAmC,MAAQ,6BAA6B,iBAAmB,0C,gOCCzKuL,EAAc,SAAC,GAAqC,EAAnCC,MAAoC,IAA7BC,EAA4B,EAA5BA,KAAgB9F,GAAY,EAAtB+F,MAAsB,kBACzDC,EAAWF,EAAKG,SAAWH,EAAKtE,MAEtC,OACE,sBAAKjH,UAAWC,IAAO0L,YAAc,KAAOF,EAAWxL,IAAOgH,MAAQ,IAAtE,UACE,8BAAMxB,EAAMmG,WACXH,GAAY,+BAAOF,EAAKtE,YAKlB4E,EAAW,SAACpG,GACvB,IAAQ6F,EAAqC7F,EAArC6F,MAAuBQ,GAAcrG,EAA9B8F,KAA8B9F,EAAxB+F,MAArB,YAA6C/F,EAA7C,IAEA,OACE,cAAC4F,EAAD,2BAAiB5F,GAAjB,aACE,oDAAc6F,GAAWQ,QAKlBvE,EAAQ,SAAC9B,GACpB,IAAQ6F,EAAqC7F,EAArC6F,MAAuBQ,GAAcrG,EAA9B8F,KAA8B9F,EAAxB+F,MAArB,YAA6C/F,EAA7C,IAEA,OACE,cAAC4F,EAAD,2BAAiB5F,GAAjB,aACE,iDAAW6F,GAAWQ,S,0DC5Bb,MAA0B,sC,OCY1BjG,IARG,SAACJ,GACjB,OACE,mCACE,qBAAKzF,UAAWC,IAAO8L,UAAWvH,IAAKuH,EAAWnH,IAAI,sB,gCCP5D,oEAAO,IAAM6C,EAAW,SAACuE,GACvB,IAAIA,EACJ,MAAO,qBAGIC,EAAmB,SAACC,GAAD,OAAe,SAACF,GAC9C,GAAIA,GAASA,EAAMpE,OAASsE,EAAW,MAAM,iBAAN,OAAwBA,EAAxB,e,mBCLzCrM,EAAOC,QAAU,CAAC,QAAU,sBAAsB,cAAgB,8B,mBCAlED,EAAOC,QAAU,CAAC,QAAU,uBAAuB,cAAgB,+B,mBCAnED,EAAOC,QAAU,CAAC,QAAU,yBAAyB,cAAgB,iC,mBCArED,EAAOC,QAAU,CAAC,QAAU,uBAAuB,WAAa,4B,mBCAhED,EAAOC,QAAU,CAAC,OAAS,uBAAuB,MAAQ,wB,uSCEpDqM,EAAW,kCACXC,EAAoB,2CACpBC,EAAa,oCACbC,EAAqB,4CACrBC,EAAc,qCAoChB7K,EAAe,CACjB8K,MAAO,CACL,CAAEpN,GAAI,EAAGG,QAAS,mBAAoBkN,YAAa,IACnD,CAAErN,GAAI,EAAGG,QAAS,sBAAuBkN,YAAa,IACtD,CAAErN,GAAI,EAAGG,QAAS,KAAMkN,YAAa,IAEvCC,YAAa,GACbpO,QAAS,KACTR,OAAQ,IAkEG6O,EAAuB,SAACD,GAAD,MAAiE,CAAEjN,KAAM0M,EAAUO,gBAI1GE,EAAY,SAAC9O,GAAD,MAAiD,CAAE2B,KAAM4M,EAAYvO,WASjF+O,EAAiB,SAACvP,GAAD,8CAA2B,WAAO8E,GAAP,eAAAG,EAAA,sEACpC7E,IAAWC,WAAWL,GADc,OACjDF,EADiD,OAEvDgF,EAbiF,CAAE3C,KAAM2M,EAAmB9N,QAapFlB,IAF+B,2CAA3B,uDAajBQ,EAAY,SAACN,GAAD,8CAA2B,WAAO8E,GAAP,eAAAG,EAAA,sEAC/B7E,IAAWE,UAAUN,GADU,OAC5CF,EAD4C,OAElDgF,EAASwK,EAAUxP,IAF+B,2CAA3B,uDAKZS,EAAe,SAACC,GAAD,8CAA2B,WAAOsE,GAAP,SAAAG,EAAA,+EAEhC7E,IAAWG,aAAaC,GAFQ,OAG3B,IAH2B,OAG1C0E,YACPJ,EAASwK,EAAU9O,IAJ8B,gDAOnDiL,QAAQC,IAAI,sBAPuC,yDAA3B,uDAWfhL,EAAY,SAAC8O,GAAD,8CAAe,WAAO1K,GAAP,eAAAG,EAAA,sEACnB7E,IAAWM,UAAU8O,GADF,OAEd,KADlB1P,EADgC,QAE7BoF,YACPJ,GAvC6BqC,EAuCHrH,EAAKA,KAAKqH,OAvC6C,CAAEhF,KAAM6M,EAAoB7H,YAoCzE,iCApCR,IAACA,IAoCO,OAAf,uDAQZpG,EAAc,SAACC,GAAD,8CAA0B,WAAO8D,EAAe2K,GAAtB,mBAAAxK,EAAA,6DAC7CjF,EAASyP,IAAWpF,KAAKrK,OADoB,SAGhCI,IAAWW,YAAYC,GAHS,UAI3B,KADlBlB,EAH6C,QAI1CoF,WAJ0C,gBAKjDJ,EAASyK,EAAevP,IALyB,8BAQ7CiC,EAAUnC,EAAKkC,SAASsI,OAAS,EAAIxK,EAAKkC,SAAS,GAAK,aAC5D8C,EAASyF,YAAW,eAAgB,CAAEC,OAAQvI,KATG,kBAU1CmK,QAAQsD,OAAOzN,IAV2B,4CAA1B,yDAcZiL,IA7HQ,WAA4M,IAA3M7K,EAA0M,uDAAhL+B,EAAc9B,EAAkK,uCAChO,OAAQA,EAAOH,MACb,KAAK0M,EACH,OAAO,2BACFxM,GADL,IAEE6M,MAAM,GAAD,mBAAM7M,EAAM6M,OAAZ,CAAmB,CAAEpN,GAAI,EAAGG,QAASK,EAAO8M,YAAaD,YAAa,OAE/E,KAAKF,EACH,OAAO,2BACF5M,GADL,IAEE6M,MAAO7M,EAAM6M,MAAM7J,QAAO,SAACsK,GAAD,OAAOA,EAAE7N,KAAOQ,EAAOsN,YAErD,KAAKd,EACH,OAAO,2BACFzM,GADL,IAEErB,QAASsB,EAAOtB,UAEpB,KAAK+N,EACH,OAAO,2BACF1M,GADL,IAEE7B,OAAQ8B,EAAO9B,SAEnB,KAAKwO,EACH,OAAO,2BACF3M,GADL,IAEErB,QAAQ,2BAAMqB,EAAMrB,SAAb,IAAsBmG,OAAQ7E,EAAO6E,WAEhD,QACE,OAAO9E,M","file":"static/js/main.327ad875.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/avataaars.68dca8f1.svg\";","import axios from 'axios';\r\n\r\nconst instance = axios.create({\r\n  withCredentials: true,\r\n  headers: { 'API-KEY': '6e65516f-e614-437d-93bf-9e85e40713b5' },\r\n  baseURL: 'https://social-network.samuraijs.com/api/1.0/',\r\n}); //создаем инстанс запроса(с параметрами запроса)\r\n\r\nexport const usersAPI = {\r\n  getUsers(currentPage, pageSize) {\r\n    return instance //обращаемся уже к инстансу запроса\r\n      .get(`users?page=${currentPage}&count=${pageSize}`)\r\n      .then((response) => response.data); //промисом вернем не весь ответ а нужную часть data\r\n  },\r\n  async unfollow(userId) {\r\n    const response = await instance.delete(`follow/${userId}`);\r\n    return response.data;\r\n  },\r\n  async follow(userId) {\r\n    const response = await instance.post(`follow/${userId}`);\r\n    return response.data;\r\n  },\r\n  // async getProfile(userId) {\r\n  //   console.warn('Obsolete method. Please use profileAPI object');\r\n  //   return profileAPI.getProfile(userId); //перенаправялем на новый метод с предупреждением\r\n  // },\r\n};\r\n\r\nexport const profileAPI = {\r\n  async getProfile(userId) {\r\n    const response = await instance.get(`profile/${userId}`);\r\n    return response.data;\r\n  },\r\n  async getStatus(userId) {\r\n    const response = await instance.get(`profile/status/${userId}`);\r\n    return response.data;\r\n  },\r\n  async updateStatus(status) {\r\n    const response = await instance.put(`profile/status`, { status: status }); //вторым параметром передаем объект json\r\n    return response.data;\r\n  },\r\n  async savePhoto(photoFile) {\r\n    const formData = new FormData(); //Конструктор FormData() создаёт новые объект FormData, если проще - HTML-форму//https://developer.mozilla.org/ru/docs/Web/API/FormData/FormData\r\n    formData.append('image', photoFile); //формируем formData по spec API\r\n    const response = await instance.put(`profile/photo`, formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    }); //вторым параметром передаем formData, а третьим объект со спец заголовками(необязательно, его формирует форма)\r\n    return response.data;\r\n  },\r\n  async saveProfile(profile) {\r\n    const response = await instance.put(`profile`, profile); //вторым параметром передаем объект json из redux-form\r\n    return response.data;\r\n  },\r\n};\r\n\r\nexport const authAPI = {\r\n  async me() {\r\n    const response = await instance.get(`auth/me`);\r\n    return response.data;\r\n  },\r\n  async login(email, password, rememberMe = false, captcha = null) {\r\n    const response = await instance.post(`auth/login`, {\r\n      email: email,\r\n      password: password,\r\n      rememberMe: rememberMe,\r\n      captcha: captcha,\r\n    });\r\n    return response.data;\r\n  },\r\n  async logout() {\r\n    const response = await instance.delete(`auth/login`);\r\n    return response.data;\r\n  },\r\n  // login(email, password, rememberMe = false) {\r\n  //   return instance.post(`auth/login`, {\r\n  //     email: email,\r\n  //     password: password,\r\n  //     rememberMe: rememberMe,\r\n  //   });\r\n  // },\r\n  // logout() {\r\n  //   return instance.delete(`auth/login`);\r\n  // },\r\n};\r\n\r\nexport const securityAPI = {\r\n  async getCaptchaUrl() {\r\n    const response = await instance.get(`security/get-captcha-url`);\r\n    return response.data;\r\n  },\r\n};\r\n","const ADD_MESSAGE = 'WAY-OF-SAMURAI/DIALOG/ADD-MESSAGE';\r\n\r\ntype DialogsType = {\r\n  id: number | null,\r\n  name: string | null\r\n}\r\ntype MessagesType = {\r\n  id: number | null,\r\n  message: string | null\r\n}\r\n\r\nconst initialState = {\r\n  dialogs: [] as Array<DialogsType>,\r\n  messages: [] as Array<MessagesType>,\r\n};\r\n\r\nexport type InitialStateType = typeof initialState\r\n\r\nconst stateDialogs: InitialStateType = {\r\n  dialogs: [\r\n    {\r\n      id: 1,\r\n      name: 'Andrew',\r\n    },\r\n    {\r\n      id: 2,\r\n      name: 'Dmitry',\r\n    },\r\n    {\r\n      id: 3,\r\n      name: 'Petya',\r\n    },\r\n    { id: 4, name: 'Sasha' },\r\n    { id: 5, name: 'Valera' },\r\n    { id: 6, name: 'Viktor' },\r\n  ],\r\n  messages: [\r\n    { id: 1, message: 'Hi' },\r\n    { id: 2, message: 'How is your it?' },\r\n    { id: 3, message: 'I am fine' },\r\n  ],\r\n};\r\n\r\nconst dialogsReducer = (state: InitialStateType = stateDialogs, action: AddMessageActionType): InitialStateType => {\r\n  switch (action.type) {\r\n    case ADD_MESSAGE:\r\n      return {\r\n        ...state,\r\n        messages: [...state.messages, { id: 4, message: action.message }],\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\ntype AddMessageActionType = {\r\n  type: typeof ADD_MESSAGE,\r\n  message: string,\r\n}//типизация action creator\r\n\r\n// export const addMessage: (message: string) => AddMessageActionType = (message) => ({ type: ADD_MESSAGE, message });\r\n\r\nexport const addMessage = (message: string): AddMessageActionType => ({ type: ADD_MESSAGE, message });\r\n\r\nexport default dialogsReducer;\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"nav\":\"Navbar_nav__1sCY-\",\"item\":\"Navbar_item__1MKSx\",\"activeLink\":\"Navbar_activeLink__3vO2y\"};","import { NavLink } from 'react-router-dom';\r\nimport styles from './Navbar.module.css';\r\n// import DialogItem from './../Dialogs/DialogItem/DialogItem';\r\n\r\nconst Navbar = () => {\r\n  // debugger\r\n\r\n  // const dialogsElements = props.state.dialogsData.map((dialog, i) => <DialogItem key={i} name={dialog.name} id={dialog.id} avatar={dialog.avatar}/>)\r\n\r\n  return (\r\n    <nav className={styles.nav}>\r\n      <div className={styles.item}>\r\n        <NavLink to='/profile' activeClassName={styles.activeLink}>\r\n          Profile\r\n        </NavLink>\r\n      </div>\r\n      <div className={styles.item}>\r\n        <NavLink to='/dialogs' activeClassName={styles.activeLink}>\r\n          Messages\r\n        </NavLink>\r\n      </div>\r\n      <div className={styles.item}>\r\n        <NavLink to='/news' activeClassName={styles.activeLink}>\r\n          News\r\n        </NavLink>\r\n      </div>\r\n      <div className={styles.item}>\r\n        <NavLink to='/music' activeClassName={styles.activeLink}>\r\n          Music\r\n        </NavLink>\r\n      </div>\r\n      <div className={styles.item}>\r\n        <NavLink to='/users' activeClassName={styles.activeLink}>\r\n          Users\r\n        </NavLink>\r\n        {/* { dialogsElements } */}\r\n      </div>\r\n      <div className={styles.item}>\r\n        <NavLink to='/setings' activeClassName={styles.activeLink}>\r\n          Settings\r\n        </NavLink>\r\n      </div>\r\n    </nav>\r\n  );\r\n};\r\n\r\nexport default Navbar;\r\n","import styles from './News.module.css'\r\n\r\nconst News = () => (\r\n  <div>\r\n    <p>News</p>\r\n    <div className={styles.wrapper}>\r\n      <div className={styles.wrapper__item}>\r\n        News #1\r\n      </div>\r\n      <div className={styles.wrapper__item}>\r\n        News #2\r\n      </div>\r\n    </div>\r\n  </div>\r\n)\r\n\r\nexport default News","import styles from './Music.module.css'\r\n\r\nconst Music = () => (\r\n  <div>\r\n    <p>Music</p>\r\n    <div className={styles.wrapper}>\r\n      <div className={styles.wrapper__item}>\r\n        Albums #1\r\n      </div>\r\n      <div className={styles.wrapper__item}>\r\n      Albums #2\r\n      </div>\r\n    </div>\r\n  </div>\r\n)\r\n\r\nexport default Music","import styles from './Setings.module.css'\r\n\r\nconst Setings = () => (\r\n  <div>\r\n    <p>Setings</p>\r\n    <div className={styles.wrapper}>\r\n      <div className={styles.wrapper__item}>\r\n        User setings block #1\r\n      </div>\r\n      <div className={styles.wrapper__item}>\r\n        User setings block #2\r\n      </div>\r\n    </div>\r\n  </div>\r\n)\r\n\r\nexport default Setings","export const updateObjectInArray = (items, itemId, objPropName, newObjProps) => {\r\n  return items.map((user) => {\r\n    if (user[objPropName] === itemId) {\r\n      return { ...user, ...newObjProps };\r\n    }\r\n    return user;\r\n  });\r\n};\r\n//в итоге вернет нам новый массив, в котором заменит, если найдет совпадение по objPropName из объекта с таким itemId, создаст копию объекта и заменит старые свойства деструктуризацией из новых свойств newObjProps\r\n","import { usersAPI } from '../api/api';\r\nimport { updateObjectInArray } from '../utils/object-helpers';\r\nimport {PhotosType, UsersType} from '../types/types'\r\n\r\nconst FOLLOW = 'WAY-OF-SAMURAI/USERS/FOLLOW'; //add redux-ducks\r\nconst UNFOLLOW = 'WAY-OF-SAMURAI/USERS/UNFOLLOW';\r\nconst SET_USERS = 'WAY-OF-SAMURAI/USERS/SET_USERS';\r\nconst SET_CURRENT_PAGE = 'WAY-OF-SAMURAI/USERS/SET_CURRENT_PAGE';\r\nconst SET_TOTAL_USERS_COUNT = 'WAY-OF-SAMURAI/USERS/SET_TOTAL_USERS_COUNT';\r\nconst TOGGLE_IS_FETCHING = 'WAY-OF-SAMURAI/USERS/TOGGLE_IS_FETCHING';\r\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'WAY-OF-SAMURAI/USERS/TOGGLE_IS_FOLLOWING_PROGRESS';\r\n\r\n//выносим типы в отдельный файл types и импортируем их по необходимости\r\n// type PhotosType = {\r\n//   small: string | null,\r\n//   large: string | null,\r\n// }\r\n\r\n// type UsersType = {\r\n//   name: string | null,\r\n//   id: number | null,\r\n//   uniqueUrlName:null,\r\n//   photos: PhotosType,\r\n//   status: string | null,\r\n//   followed: boolean,\r\n// }\r\n\r\nlet initialState = {\r\n  users: [] as Array<UsersType>,\r\n  pageSize: 10 as number,//remove | null\r\n  totalUsersCount: 0 as number,//remove | null\r\n  currentPage: 1 as number,//remove | null\r\n  isFetching: true as boolean,\r\n  followingInProgress: [] as Array<number | null>,//array of users Id\r\n};\r\n\r\nexport type InitialStateType = typeof initialState\r\n\r\nconst usersReducer = (state: InitialStateType = initialState, action: FollowSuccessActionType | UnfollowSuccessActionType | SetUsersActionType | SetCurrentPageActionType | SetTotalUsersCountActionType | ToggleIsFetchingActionType | ToggleFollowingProgressActionType): InitialStateType => {\r\n  switch (action.type) {\r\n    //======\r\n    //рефакторинг, вынесение дублирующей логики из follow и unfollow во вспомогутальную функцию updateObjectInArray из утилит\r\n    case FOLLOW:\r\n      return {\r\n        ...state, //создаем копию стейта(работать можем только с копией)\r\n        users: updateObjectInArray(state.users, action.userId, 'id', { followed: true }),\r\n      };\r\n    case UNFOLLOW:\r\n      return {\r\n        ...state, //создаем копию стейта(работать можем только с копией)\r\n        users: updateObjectInArray(state.users, action.userId, 'id', { followed: false }),\r\n      };\r\n    //рефакторинг, вынесение дублирующей логики из follow и unfollow во вспомогутальную функцию updateObjectInArray из утилит\r\n    //=====\r\n\r\n    // case FOLLOW:\r\n    //   return {\r\n    //     ...state, //создаем копию стейта(работать можем только с копией)\r\n    //     users: state.users.map((user) => {\r\n    //       if (user.id === action.userId) {\r\n    //         return { ...user, followed: true };\r\n    //       } //мапим массив юзеров(если id юзера совпадает с id пришедшим из AC) то возвращаем в глубокую копию новый объект с добавленным статусом followed true у юзера\r\n    //       return user; //если id не совпадает, возвращаем тот же самый объект юзер\r\n    //     }),\r\n    //   };\r\n    // case UNFOLLOW:\r\n    //   return {\r\n    //     ...state, //создаем копию стейта(работать можем только с копией)\r\n    //     users: state.users.map((user) => {\r\n    //       if (user.id === action.userId) {\r\n    //         return { ...user, followed: false };\r\n    //       } //мапим массив юзеров(если id юзера совпадает с id пришедшим из AC) то возвращаем в глубокую копию новый объект с измененным статусом followed false у юзера\r\n    //       return user; //если id не совпадает, возвращаем тот же самый объект юзер\r\n    //     }),\r\n    //   };\r\n    case SET_USERS: {\r\n      return {\r\n        ...state,\r\n        users: action.users, //перезатираем массив юзеров\r\n        // users: [...state.users, ...action.users],\r\n      }; //с сервера придут пользователи, мы должны взять старый стейт(сделать копию) и дополнить его новыми пользователями пришедшими из экшна (склеить два массива спред оператором)\r\n    }\r\n    case SET_CURRENT_PAGE: {\r\n      return {\r\n        ...state,\r\n        currentPage: action.currentPage,\r\n      };\r\n    }\r\n    case SET_TOTAL_USERS_COUNT: {\r\n      return {\r\n        ...state,\r\n        totalUsersCount: action.totalUsersCount,\r\n      };\r\n    }\r\n    case TOGGLE_IS_FETCHING: {\r\n      return {\r\n        ...state,\r\n        isFetching: action.isFetching,\r\n      };\r\n    }\r\n    case TOGGLE_IS_FOLLOWING_PROGRESS: {\r\n      return {\r\n        ...state,\r\n        followingInProgress: action.isFetching\r\n          ? [...state.followingInProgress, action.userId] //если isF true добавляем в массив id из экшена\r\n          : state.followingInProgress.filter((id) => id !== action.userId), //если isF false фильтрация вернут новый массив\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\n//ACTypes\r\ntype FollowSuccessActionType = {\r\n  type: typeof FOLLOW,\r\n  userId: number | null\r\n}\r\ntype UnfollowSuccessActionType = {\r\n  type: typeof UNFOLLOW,\r\n  userId: number | null\r\n}\r\ntype SetUsersActionType = {\r\n  type: typeof SET_USERS,\r\n  users: Array<UsersType>\r\n}\r\ntype SetCurrentPageActionType = {\r\n  type: typeof SET_CURRENT_PAGE,\r\n  currentPage: number\r\n}//remove | null\r\ntype SetTotalUsersCountActionType = {\r\n  type: typeof SET_TOTAL_USERS_COUNT,\r\n  totalUsersCount: number\r\n}//remove | null\r\ntype ToggleIsFetchingActionType = {\r\n  type: typeof TOGGLE_IS_FETCHING,\r\n  isFetching: boolean\r\n}\r\ntype ToggleFollowingProgressActionType = {\r\n  type: typeof TOGGLE_IS_FOLLOWING_PROGRESS,\r\n  isFetching: boolean,\r\n  userId: number | null\r\n  // userId: Array<number | null>\r\n}\r\n\r\n//создаем функции action creator, которая создает(возвращает) объект действие {action}\r\n//переименовываем AC без окончания AC(хак с mdtp )\r\nexport const followSuccess = (userId: number | null): FollowSuccessActionType => ({ type: FOLLOW, userId }); //переименуем из-за thunkCreate\r\nexport const unfollowSuccess = (userId: number | null): UnfollowSuccessActionType => ({ type: UNFOLLOW, userId }); //переименуем из-за thunkCreate\r\nexport const setUsers = (users: Array<UsersType>): SetUsersActionType => ({ type: SET_USERS, users }); //возьмем данные о юзерах с сервера и поместим их потом в стейт\r\nexport const setCurrentPage = (currentPage: number): SetCurrentPageActionType => ({ type: SET_CURRENT_PAGE, currentPage });//remove | null\r\nexport const setTotalUsersCount = (totalUsersCount: number): SetTotalUsersCountActionType => ({\r\n  type: SET_TOTAL_USERS_COUNT,\r\n  totalUsersCount, //когда ключ и значение не одинаковы(специально)\r\n});//remove | null\r\n// export const setTotalUsersCount = (totalUsersCount: number | null) => ({\r\n//   type: SET_TOTAL_USERS_COUNT,\r\n//   count: totalUsersCount, //когда ключ и значение не одинаковы(специально)\r\n// });\r\nexport const toggleIsFetching = (isFetching: boolean): ToggleIsFetchingActionType => ({\r\n  type: TOGGLE_IS_FETCHING,\r\n  isFetching,\r\n});\r\nexport const toggleFollowingProgress = (isFetching: boolean, userId: number | null): ToggleFollowingProgressActionType => ({\r\n  type: TOGGLE_IS_FOLLOWING_PROGRESS,\r\n  isFetching,\r\n  userId,\r\n});\r\n\r\n//создаем функции thunk creator, которая создает(возвращает) thunk(dispatch action)\r\n//переименовываем AC без окончания AC\r\nexport const requestUsers = (page: number, pageSize: number | null) => async (dispatch: any) => {\r\n  dispatch(setCurrentPage(page)); //from onPageChanged(активная страница)\r\n  dispatch(toggleIsFetching(true)); //запрос ушел preloader виден\r\n  const data = await usersAPI.getUsers(page, pageSize);\r\n  dispatch(toggleIsFetching(false)); //запрос пришел preloader скрывается\r\n  dispatch(setUsers(data.items)); // у usersAPI дергаем метод getUsers//получаем user из data(данные) items(объект с юзерами) и диспачим setUsers\r\n  dispatch(setTotalUsersCount(data.totalCount));\r\n}; //remove page | null\r\n\r\n// export const requestUsers = (page, pageSize) => {\r\n//   // debugger;\r\n//   return (dispatch) => {\r\n//     dispatch(setCurrentPage(page)); //from onPageChanged(активная страница)\r\n//     dispatch(toggleIsFetching(true)); //запрос ушел preloader виден\r\n//     usersAPI.getUsers(page, pageSize).then((data) => {\r\n//       dispatch(toggleIsFetching(false)); //запрос пришел preloader скрывается\r\n//       dispatch(setUsers(data.items)); // у usersAPI дергаем метод getUsers//получаем user из data(данные) items(объект с юзерами) и диспачим setUsers\r\n//       dispatch(setTotalUsersCount(data.totalCount));\r\n//     });\r\n//   };\r\n// };//with then\r\n\r\n//рефакторинг, вынесение дублирующей логики из follow и unfollow в функцию followUnfollowFlow\r\nexport const followUnfollowFlow = async (dispatch: any, userId: number | null, apiMethod: any, actionCreator: any) => {\r\n  dispatch(toggleFollowingProgress(true, userId));\r\n  const data = await apiMethod(userId);\r\n  if (data.resultCode === 0) {\r\n    dispatch(actionCreator(userId));\r\n  } //если отписка произошла и сервер подтвердил(resultCode === 0) диспачим в редьюсер\r\n  dispatch(toggleFollowingProgress(false, userId));\r\n};\r\n\r\nexport const follow = (userId: number | null) => async (dispatch: any) => {\r\n  // const apiMethod = usersAPI.follow.bind(usersAPI);\r\n  // const actionCreator = followSuccess;\r\n  followUnfollowFlow(dispatch, userId, usersAPI.follow.bind(usersAPI), followSuccess);\r\n\r\n  // dispatch(toggleFollowingProgress(true, userId));\r\n  // const data = await apiMethod(userId);\r\n  // if (data.resultCode === 0) {\r\n  //   dispatch(actionCreator(userId));\r\n  // } //если подписка произошла и сервер подтвердил(resultCode === 0) диспачим в редьюсер\r\n  // dispatch(toggleFollowingProgress(false, userId));\r\n}; //convert to async/await\r\n\r\nexport const unfollow = (userId: number | null) => async (dispatch: any) => {\r\n  // const apiMethod = usersAPI.unfollow.bind(usersAPI);\r\n  // const actionCreator = unfollowSuccess;\r\n  followUnfollowFlow(dispatch, userId, usersAPI.unfollow.bind(usersAPI), unfollowSuccess);\r\n\r\n  // dispatch(toggleFollowingProgress(true, userId));\r\n  // const data = await apiMethod(userId);\r\n  // if (data.resultCode === 0) {\r\n  //   dispatch(actionCreator(userId));\r\n  // } //если отписка произошла и сервер подтвердил(resultCode === 0) диспачим в редьюсер\r\n  // dispatch(toggleFollowingProgress(false, userId));\r\n}; //convert to async/await\r\n\r\nexport default usersReducer;\r\n","import styles from './Paginator.module.css';\r\nimport React, { useState } from 'react';\r\n\r\ntype PropsType = {\r\n  totalItemsCount: number,\r\n  pageSize: number,\r\n  onPageChanged: (page: number) => void,\r\n  currentPage: number,\r\n  portionSize?: number//'?' необязательный параметр\r\n}//типизируем пропсы и ниже компонент: React.FC<Props>\r\n\r\nconst Paginator: React.FC<PropsType> = ({ totalItemsCount, pageSize, onPageChanged, currentPage, portionSize = 10 }) => {\r\n  const pagesCount = Math.ceil(totalItemsCount / pageSize); //кол-во странииц\r\n  const portionCount = Math.ceil(pagesCount / portionSize); //кол-во порций\r\n  const [portionNumber, setPortionNumber] = useState<number>(Math.ceil(currentPage / portionSize)); //отслеживаем номер порции и его изменение//решение со сбросом порции при смене страницы\r\n  // const [portionNumber, setPortionNumber] = useState(1); //отслеживаем номер порции и его изменение\r\n  const leftPortionPageNumber = (portionNumber - 1) * portionSize + 1; //номер левого элемента порции\r\n  const rightPortionPageNumber = portionNumber * portionSize; //номер правого элемента порции\r\n  const pages: number[] = [];\r\n  // const pages: Array<number> = [];\r\n  for (let i = 1; i <= pagesCount; i++) pages.push(i);\r\n\r\n  return (\r\n    <div className={styles.paginationBlockWrapper}>\r\n      <div className={styles.paginationBlock}>\r\n        {portionNumber > 1 ? (\r\n          <button\r\n            className={styles.buttonPrev}\r\n            onClick={() => {\r\n              setPortionNumber(portionNumber - 1);\r\n            }}>\r\n            PREV\r\n          </button>\r\n        ) : (\r\n          <button disabled={true}>PREV</button>\r\n        )}\r\n        {pages\r\n          .filter((page) => page >= leftPortionPageNumber && page <= rightPortionPageNumber)\r\n          .map((page, id) => {\r\n            return (\r\n              <span\r\n                key={id}\r\n                onClick={(event) => {\r\n                  onPageChanged(page);\r\n                }}\r\n                className={`${styles.pagination} ${\r\n                  currentPage === page ? styles.selectedPage : ''\r\n                }`}>\r\n                {page}\r\n              </span>\r\n            );\r\n          })}\r\n        {portionNumber < portionCount ? (\r\n          <button\r\n            className={styles.buttonNext}\r\n            onClick={() => {\r\n              setPortionNumber(portionNumber + 1);\r\n            }}>\r\n            NEXT\r\n          </button>\r\n        ) : (\r\n          <button disabled={true}>NEXT</button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Paginator;\r\n","import styles from './Users.module.css';\r\nimport avataaars from './../../../src/assets/images/avataaars.svg';\r\nimport { NavLink } from 'react-router-dom';\r\n\r\nconst User = ({ followingInProgress, follow, unfollow, user }) => {\r\n  return (\r\n    <div>\r\n      <div>\r\n        <div>\r\n          <NavLink to={'/profile/' + user.id}>\r\n            <img\r\n              className={styles.userPhoto}\r\n              src={user.photos.small != null ? user.photos.small : avataaars} //добавляем проверку, если с сервера не пришла аватарка, поставить заглушку\r\n              alt='avatar'\r\n            />\r\n          </NavLink>\r\n        </div>\r\n        <div className={styles.userButton}>\r\n          {user.followed ? (\r\n            <button\r\n              disabled={followingInProgress.some((id) => id === user.id)}\r\n              onClick={() => {\r\n                unfollow(user.id);\r\n              }}>\r\n              Unfollow\r\n            </button>\r\n          ) : (\r\n            <button\r\n              disabled={followingInProgress.some((id) => id === user.id)}\r\n              onClick={() => {\r\n                follow(user.id);\r\n              }}>\r\n              Follow\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className={styles.wrapper__item}>\r\n        <div>\r\n          <div>{user.name}</div>\r\n          <div>{user.status}</div>\r\n        </div>\r\n        <div>\r\n          {/* <div>{user.location.country}</div>\r\n                <div>{user.location.city}</div> */}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default User;\r\n","import styles from './Users.module.css';\r\nimport React from 'react';\r\nimport Paginator from '../common/Paginator/Paginator';\r\nimport User from './User';\r\nimport {UsersType} from '../../types/types'\r\n\r\n\r\ntype PropsType = {\r\n  totalUsersCount: number,\r\n  pageSize: number,\r\n  onPageChanged: (page: number) => void,\r\n  currentPage: number,\r\n  users: Array<UsersType>,\r\n  followingInProgress: Array<number | null>,\r\n  follow: (userId: number | null) => void,\r\n  unfollow: (userId: number | null) => void,\r\n}\r\n\r\nconst Users: React.FC<PropsType> = ({\r\n  totalUsersCount,\r\n  pageSize,\r\n  onPageChanged,\r\n  currentPage,\r\n  users,\r\n  followingInProgress,\r\n  follow,\r\n  unfollow,\r\n}) => {\r\n  return (\r\n    <div>\r\n      <Paginator //выносим логику пагинации в отдельный компонент, прокидываем пропсы\r\n        totalItemsCount={totalUsersCount}\r\n        pageSize={pageSize}\r\n        onPageChanged={onPageChanged}\r\n        currentPage={currentPage}\r\n        />\r\n      {users.map((user) => (\r\n        <div className={styles.wrapper} key={user.id}>\r\n          <User //выносим логику в компонент, прокидываем пропсы\r\n            followingInProgress={followingInProgress}\r\n            follow={follow}\r\n            unfollow={unfollow}\r\n            user={user}\r\n          />\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Users;\r\n","import { createSelector } from 'reselect';\r\nimport {AppStateType} from './redux-store'\r\n\r\n\r\nconst getUsersSelector = (state: AppStateType) => {\r\n  return state.usersPage.users;\r\n};\r\nexport const getUsers = createSelector(getUsersSelector, (users) => {\r\n  return users.filter((u) => true);\r\n}); //test reselec\r\n\r\nexport const getPageSize = (state: AppStateType) => {\r\n  return state.usersPage.pageSize;\r\n};\r\nexport const getTotalUsersCount = (state: AppStateType) => {\r\n  return state.usersPage.totalUsersCount;\r\n};\r\nexport const getCurrentPage = (state: AppStateType) => {\r\n  return state.usersPage.currentPage;\r\n};\r\nexport const getIsFetching = (state: AppStateType) => {\r\n  return state.usersPage.isFetching;\r\n};\r\nexport const getFollowingInProgress = (state: AppStateType) => {\r\n  return state.usersPage.followingInProgress;\r\n};\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport {\r\n  follow,\r\n  unfollow,\r\n  requestUsers,\r\n  // setCurrentPage,\r\n  // toggleFollowingProgress,\r\n} from '../../redux/users-reducer';\r\nimport Users from './Users';\r\nimport Preloader from '../common/preloader/Preloader';\r\nimport { compose } from 'redux';\r\nimport {\r\n  getFollowingInProgress,\r\n  getIsFetching,\r\n  getCurrentPage,\r\n  getTotalUsersCount,\r\n  getPageSize,\r\n  getUsers,\r\n} from '../../redux/users-selectors';\r\nimport {UsersType} from '../../types/types'\r\nimport {AppStateType} from '../../redux/redux-store'\r\n\r\ntype MapStatePropsType = {\r\n  totalUsersCount: number,\r\n  pageSize: number,\r\n  currentPage: number,\r\n  users: UsersType[],\r\n  followingInProgress: Array<number | null>,\r\n  isFetching: boolean,\r\n}\r\n\r\ntype MapDispatchPropsType = {\r\n  follow: (userId: number | null) => void,\r\n  unfollow: (userId: number | null) => void,\r\n  requestUsers: (currentPage: number, pageSize: number) => void,\r\n  // onPageChanged: (currentPage: number) => void,\r\n  // setCurrentPage: (currentPage: number) => void,\r\n  // toggleFollowingProgress: (isFetching: boolean, userId: number | null) => void,\r\n}\r\n\r\ntype OwnPropsType = {\r\n  pageTitle: string,//\r\n}\r\n\r\ntype PropsType = MapStatePropsType & MapDispatchPropsType & OwnPropsType\r\n\r\n\r\n// type PropsType = {\r\n//   pageTitle: string,//\r\n//   totalUsersCount: number,\r\n//   pageSize: number,\r\n//   currentPage: number,\r\n//   users: Array<UsersType>,\r\n//   followingInProgress: Array<number | null>,\r\n//   isFetching: boolean,\r\n//   follow: () => void,\r\n//   unfollow: () => void,\r\n//   onPageChanged: (currentPage: number) => void,\r\n//   requestUsers: (currentPage: number, pageSize: number) => void,\r\n// }\r\n\r\nclass UsersContainer extends React.Component<PropsType> {\r\n\r\n  componentDidMount() {\r\n    const {currentPage, pageSize} = this.props\r\n    this.props.requestUsers(currentPage, pageSize);\r\n  }\r\n\r\n  onPageChanged = (currentPage: number) => {\r\n    this.props.requestUsers(currentPage, this.props.pageSize);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <h2>{this.props.pageTitle}</h2>\r\n        {this.props.isFetching ? (\r\n          <Preloader /> //вынесли компоненту в common/preloader\r\n        ) : null}\r\n        <Users\r\n          totalUsersCount={this.props.totalUsersCount}\r\n          pageSize={this.props.pageSize}\r\n          currentPage={this.props.currentPage}\r\n          users={this.props.users}\r\n          onPageChanged={this.onPageChanged}\r\n          follow={this.props.follow}\r\n          unfollow={this.props.unfollow}\r\n          followingInProgress={this.props.followingInProgress}\r\n        />\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nlet mapStateToProps = (state: AppStateType): MapStatePropsType => {\r\n  // debugger;\r\n  return {\r\n    users: getUsers(state), //test reselect\r\n    pageSize: getPageSize(state),\r\n    totalUsersCount: getTotalUsersCount(state),\r\n    currentPage: getCurrentPage(state),\r\n    isFetching: getIsFetching(state),\r\n    followingInProgress: getFollowingInProgress(state),\r\n  };\r\n};\r\n\r\nexport default compose(\r\n  connect<MapStatePropsType, MapDispatchPropsType, OwnPropsType, AppStateType>(mapStateToProps, {\r\n    follow,\r\n    unfollow,\r\n    requestUsers,\r\n    // setCurrentPage,\r\n    // toggleFollowingProgress,\r\n  }),\r\n)(UsersContainer);\r\n","import { authAPI, securityAPI } from '../api/api';\r\nimport { stopSubmit } from 'redux-form';//add @types/redux-form\r\nconst SET_USER_DATA = 'WAY-OF-SAMURAI/AUTH/SET_USER_DATA'; //add redux-ducks\r\n// const SET_USER_LOGIN_DATA = 'WAY-OF-SAMURAI/AUTH/SET_USER_LOGIN_DATA';\r\nconst SET_CAPTCHA_URL_SUCCESS = 'WAY-OF-SAMURAI/AUTH/SET_CAPTCHA_URL_SUCCESS';\r\n\r\nexport type InitialStateType = {\r\n  userId: number | null,\r\n  email: string | null,\r\n  login: string | null,\r\n  isAuth: boolean,\r\n  captchaUrl: string | null,\r\n}\r\n\r\nlet initialState: InitialStateType = {\r\n  userId: null,\r\n  email: null,\r\n  login: null,\r\n  isAuth: false, //isAuth флаг того, что юзер залогинен\r\n  captchaUrl: null, //по наличию капчи в стейте отображаем капчу и поле ввода в форме на странице логина\r\n}; //инициализируем стейт согласно данным из API response\r\n\r\n// let initialState = {\r\n//   userId: null as number | null,\r\n//   email: null as string | null,\r\n//   login: null as string | null,\r\n//   isAuth: false as boolean, //isAuth флаг того, что юзер залогинен\r\n//   captchaUrl: null string | null, //по наличию капчи в стейте отображаем капчу и поле ввода в форме на странице логина\r\n// }; //инициализируем стейт согласно данным из API response\r\n\r\n// export type InitialStateType = typeof initialState\r\n\r\nconst authReducer = (state: InitialStateType = initialState, action: SetAuthUserDataActionType | SetCaptchaUrlSuccessActionType): InitialStateType => {\r\n  switch (action.type) {\r\n    case SET_USER_DATA: {\r\n      return {\r\n        ...state,\r\n        ...action.payload, //в экшене будет сидеть объект data,который мы деструктурируем\r\n      };\r\n    }\r\n    // case SET_USER_LOGIN_DATA: {\r\n    //   return {\r\n    //     isAuth: true, //меняем флаг на true если пришли пользовательские данные\r\n    //   };\r\n    // }\r\n    case SET_CAPTCHA_URL_SUCCESS: {\r\n      return {\r\n        ...state,\r\n        captchaUrl: action.captchaUrl,\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\ntype SetAuthUserDataActionPayloadType = {\r\n  userId: number | null, email: string | null, login: string | null, isAuth: boolean, captchaUrl: string | null\r\n}\r\n\r\nexport type SetAuthUserDataActionType = {\r\n  type: typeof SET_USER_DATA,\r\n  payload: SetAuthUserDataActionPayloadType\r\n}\r\n\r\nexport type SetCaptchaUrlSuccessActionType = {\r\n  type: typeof SET_CAPTCHA_URL_SUCCESS,\r\n  captchaUrl: string | null\r\n}\r\n//AC\r\nexport const setAuthUserData = (userId: number | null, email: string | null, login: string | null, isAuth: boolean, captchaUrl: string | null = null): SetAuthUserDataActionType => ({\r\n  type: SET_USER_DATA,\r\n  payload: { userId, email, login, isAuth, captchaUrl },\r\n}); //AC деструктурируем объект data до составляющих userId, email, login, isAuth true, зануляем капчу\r\n\r\nexport const setCaptchaUrlSuccess = (captchaUrl: string | null): SetCaptchaUrlSuccessActionType => ({\r\n  type: SET_CAPTCHA_URL_SUCCESS, //\r\n  captchaUrl,\r\n});\r\n\r\n//TC\r\n\r\nexport const getAuthUserData = () => async (dispatch: any) => {\r\n  const data = await authAPI.me();\r\n  if (data.resultCode === 0) {\r\n    let { id, email, login } = data.data;\r\n    dispatch(setAuthUserData(id, email, login, true)); //isAuth true\r\n  }\r\n};\r\n\r\n//TC to login and logout\r\nexport const login = (email: string, password: string, rememberMe: boolean, captcha: any) => async (dispatch: any) => {\r\n  const data = await authAPI.login(email, password, rememberMe, captcha);\r\n  if (data.resultCode === 0) {\r\n    dispatch(getAuthUserData());\r\n  } else {\r\n    if (data.resultCode === 10) {\r\n      dispatch(getCaptchaUrl());\r\n    } //при ответе сервера 10 диспачим санку на получение капчи\r\n    // let action = stopSubmit('login', { email: 'Email is wrong' }); //встроенный экш редакс-форм, передаем в него имя формы(_error - или общую ошибку формы), вторым параметром передаем объект с проблемными полями, которые вызвали ошибку\r\n    let message = data.messages.length > 0 ? data.messages[0] : 'some error';\r\n    dispatch(stopSubmit('login', { _error: message })); //диспачим экшен с именем формы и объектом с общей ощибкой формы и причиной\r\n  }\r\n};\r\n\r\nexport const logout = () => async (dispatch: any) => {\r\n  const data = await authAPI.logout();\r\n  if (data.resultCode === 0) {\r\n    dispatch(setAuthUserData(null, null, null, false)); //при логауте зануляем все данные и ставим флаг isAuth false\r\n  }\r\n};\r\n\r\nexport const getCaptchaUrl = () => async (dispatch: any) => {\r\n  const data = await securityAPI.getCaptchaUrl();\r\n  dispatch(setCaptchaUrlSuccess(data.url));\r\n}; //получаем капчу с сервера\r\n\r\n// export const getAuthUserData = () => (dispatch) => {\r\n//   return authAPI.me().then((data) => {\r\n//     if (data.resultCode === 0) {\r\n//       let { id, email, login } = data.data;\r\n//       dispatch(setAuthUserData(id, email, login, true)); //isAuth true\r\n//     }\r\n//   });\r\n// };//with then\r\n\r\nexport default authReducer;\r\n","import { Field, reduxForm } from 'redux-form';\r\nimport { Input } from '../common/FormsControls/FormsControls';\r\nimport { required } from '../../utils/validators/validators';\r\nimport { connect } from 'react-redux';\r\nimport { login } from '../../redux/auth-reducer';\r\nimport { Redirect } from 'react-router';\r\nimport styles from '../common/FormsControls/FormsControls.module.css';\r\nimport stylesLogin from './Login.module.css';\r\n\r\nconst LoginForm = ({ handleSubmit, error, captchaUrl }) => {\r\n  return (\r\n    <form onSubmit={handleSubmit} className={styles.loginFormWrapper}>\r\n      <div>\r\n        <Field placeholder={'Email'} name={'email'} component={Input} validate={[required]} />\r\n      </div>\r\n      <div>\r\n        <Field\r\n          placeholder={'Password'}\r\n          name={'password'}\r\n          type={'password'}\r\n          component={Input}\r\n          validate={[required]}\r\n        />\r\n      </div>\r\n      <div>\r\n        <Field component={Input} name={'rememberMe'} type={'checkbox'} />\r\n      </div>\r\n      {error && <div className={styles.formSummaryError}>{error}</div>}\r\n      {captchaUrl && ( //по условию наличия в стейте капчи покажем ее на странице формы\r\n        <div>\r\n          <img src={captchaUrl} alt='captcha' />\r\n          <Field placeholder={'captcha'} name={'captcha'} component={Input} validate={[required]} />\r\n        </div>\r\n      )}\r\n      <div>\r\n        <button>Login</button>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\n//handleSubmit выполнит следующие действия\r\n//e.preventDefault\r\n//get all form data and put them to object\r\n//props.onSubmit(formData)\r\n\r\n//unique name for the form\r\n//оборачиваем нашу форму HOCом reduxForm\r\nconst LoginReduxForm = reduxForm({ form: 'login' })(LoginForm);\r\n\r\nconst Login = (props) => {\r\n  const onSubmit = (formData) => {\r\n    props.login(formData.email, formData.password, formData.rememberMe, formData.captcha);\r\n  };\r\n\r\n  if (props.isAuth) {\r\n    return <Redirect to={'/profile'} />;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1 className={stylesLogin.loginH1}>Login</h1>\r\n      <LoginReduxForm onSubmit={onSubmit} captchaUrl={props.captchaUrl} />\r\n      <div className={stylesLogin.loginblock}>\r\n        <h2>Данные тестового аккаунта:</h2>\r\n        <p>Email: free@samuraijs.com</p>\r\n        <p>Password: free</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n  isAuth: state.auth.isAuth,\r\n  captchaUrl: state.auth.captchaUrl,\r\n});\r\n\r\nexport default connect(mapStateToProps, { login })(Login);\r\n","import styles from './Header.module.css';\r\nimport { NavLink } from 'react-router-dom';\r\n\r\nconst Header = (props) => {\r\n  return (\r\n    <header className={styles.header}>\r\n      <div>\r\n        {/* <img\r\n          src='https://freepngimg.com/thumb/logo/69613-litecoin-bitcoin-cryptocurrency-london-bull-logo.png'\r\n          width='40'\r\n          height='40'\r\n          alt='logo'\r\n        /> */}\r\n      </div>\r\n      <div className={styles.login}>\r\n        {props.isAuth ? (\r\n          <div>\r\n            {props.login} <button onClick={props.logout}>Log out</button>\r\n          </div>\r\n        ) : (\r\n          <NavLink to={'/Login/'}>Login</NavLink>\r\n        )}\r\n      </div>\r\n    </header> //isAuth true - покажем логин, иначе ссылку на залогинивание\r\n  );\r\n};\r\n\r\nexport default Header;\r\n","import React from 'react';\r\nimport Header from './Header';\r\nimport { connect } from 'react-redux';\r\nimport { logout } from '../../redux/auth-reducer';\r\n\r\nclass HeaderContainer extends React.Component {\r\n  // componentDidMount() {\r\n  //   this.props.getAuthUserData();\r\n  // }//переносим запрос в App\r\n  render() {\r\n    return <Header {...this.props} />; //пробрасываем все пропсы ниже в целевую компоненту\r\n  }\r\n}\r\n\r\nlet mapStateToProps = (state) => ({\r\n  login: state.auth.login, //логин покажем после авторизации\r\n  isAuth: state.auth.isAuth, //флаг авторизации\r\n});\r\n\r\nexport default connect(mapStateToProps, { logout })(HeaderContainer);\r\n","import { getAuthUserData } from './auth-reducer';\r\nconst INITIALIZED_SUCCESS = 'INITIALIZED_SUCCESS';\r\n\r\nexport type InitialStateType = {\r\n  initialized: boolean,\r\n}\r\n\r\nconst initialState: InitialStateType = {\r\n  initialized: false,\r\n}; //инициализируем стейт, initialized флаг того, что юзер залогинен(нет)\r\n\r\nconst appReducer = (state: InitialStateType = initialState, action: InitializedSuccessActionType): InitialStateType => {\r\n  switch (action.type) {\r\n    case INITIALIZED_SUCCESS: {\r\n      return {\r\n        ...state,\r\n        initialized: true, // isAuth: true, //меняем флаг на true если пришли пользовательские данные\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};//TS редьюсер на входе и на выходе должен принять и вернуть state: InitialStateType\r\n\r\nexport type InitializedSuccessActionType = {\r\n  type: typeof INITIALIZED_SUCCESS,\r\n}//TS typeof на этапе компиляции выведет значение константы (строку 'INITIALIZED_SUCCESS')\r\n\r\n//AC\r\nexport const initializedSuccess = (): InitializedSuccessActionType => ({\r\n  type: INITIALIZED_SUCCESS,\r\n}); //TS возвращаемое значение функции пишем после (параметров): и перед =>\r\n\r\n//TC\r\nexport const initializeApp = () => (dispatch: any) => {\r\n  let promise = dispatch(getAuthUserData()); //диспачим получение юзерских данных\r\n  //dispatch(somethingelse())//диспачим получение любых других данных\r\n  //и когда промис (в authAPI.me) зарезолвится, мы его здесь получим как результат promise и после этого мы задиспачим AC success\r\n  // promise.then(() => {dispatch(initializedSuccess())})//если промис один\r\n  Promise.all([promise]).then(() => dispatch(initializedSuccess()));\r\n};\r\n\r\nexport default appReducer;\r\n","import React, { Suspense } from 'react';\r\nimport './App.css';\r\nimport Navbar from './components/Navbar/Navbar';\r\nimport News from './components/News/News';\r\nimport Music from './components/Music/Music';\r\nimport Setings from './components/Setings/Setings';\r\nimport UsersContainer from './components/Users/UsersContainer';\r\n// import DialogsContainer from './components/Dialogs/DialogsContainer';\r\n// import ProfileContainer from './components/Profile/ProfileContainer';\r\nimport Login from './components/Login/Login';\r\nimport HeaderContainer from './components/Header/HeaderContainer';\r\nimport { Route } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\nimport { withRouter, Redirect } from 'react-router';\r\n// import { compose } from 'redux';\r\nimport { initializeApp } from './redux/app-reducer';\r\nimport Preloader from './components/common/preloader/Preloader';\r\n\r\nconst DialogsContainer = React.lazy(() => import('./components/Dialogs/DialogsContainer')); // Ленивая загрузка\r\nconst ProfileContainer = React.lazy(() => import('./components/Profile/ProfileContainer'));\r\n// const Login = React.lazy(() => import('./components/Login/Login'));\r\n\r\nclass App extends React.Component {\r\n  catchAllUnhandledErrors = (reason, promise) => {\r\n    console.log('Some error occured');\r\n    // console.error(promiseRejectionEvent);\r\n  }; //Событие unhandledrejection происходит, когда Promise завершён с ошибкой, но на данную ошибку не установлен обработчик.\r\n  // debugger;\r\n  componentDidMount() {\r\n    this.props.initializeApp();\r\n    window.addEventListener('unhandledrejection', this.catchAllUnhandledErrors);\r\n  } //переносим запрос из HeaderC\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('unhandledrejection', this.catchAllUnhandledErrors);\r\n  }\r\n\r\n  render() {\r\n    if (!this.props.initialized) {\r\n      return <Preloader />;\r\n    }\r\n    return (\r\n      <div className='app-wrapper'>\r\n        <HeaderContainer />\r\n        <Navbar />\r\n        <div className='app-wrapper-content'>\r\n          <Suspense fallback={<Preloader />}>\r\n            <Route path='/profile/:userId?'>\r\n              <ProfileContainer\r\n              //:userId? опциональный параметр ХОКа withRouter\r\n              />\r\n            </Route>\r\n            <Route path='/dialogs'>\r\n              <DialogsContainer />\r\n            </Route>\r\n          </Suspense>\r\n          <Route path='/login'>\r\n            <Login />\r\n          </Route>\r\n          <Route path='/users'>\r\n            <UsersContainer pageTitle={'Самураи'} />\r\n          </Route>\r\n          <Route path='/news'>\r\n            <News />\r\n          </Route>\r\n          <Route path='/music'>\r\n            <Music />\r\n          </Route>\r\n          <Route path='/setings'>\r\n            <Setings />\r\n          </Route>\r\n          {/* <Route path='/' exact>\r\n            <Redirect to='/profile' />\r\n          </Route> */}\r\n          <Route exact path='/'>\r\n            {this.props.initialized ? <Redirect to='/profile' /> : <Login />}\r\n          </Route>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nlet mapStateToProps = (state) => ({\r\n  initialized: state.app.initialized, //получаем из стейта флаг\r\n});\r\n\r\nexport default withRouter(connect(mapStateToProps, { initializeApp })(App));\r\n// export default compose(withRouter, connect(mapStateToProps, { initializeApp })(App));//bug with compose\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","let initialState = {};\r\n\r\nexport type InitialStateType = typeof initialState\r\n\r\nconst sidebarReducer = (state: InitialStateType = initialState, action: any): InitialStateType => {\r\n  return state;\r\n};\r\n\r\nexport default sidebarReducer;\r\n","import { combineReducers, createStore, applyMiddleware } from 'redux';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport profileReducer from './profile-reducer';\r\nimport dialogsReducer from './dialog-reducer'; //add ts\r\nimport sidebarReducer from './sidebar-reducer';\r\nimport usersReducer from './users-reducer';\r\nimport authReducer from './auth-reducer';\r\nimport appReducer from './app-reducer';\r\nimport thunk from 'redux-thunk';\r\nimport { reducer as formReducer } from 'redux-form';\r\n\r\n//ключи из стейта, значения соответствующие редьюсеры(ветки нашего глобального стейта)\r\nconst rootReducer = combineReducers({\r\n  profilePage: profileReducer,\r\n  dialogsPage: dialogsReducer,\r\n  sidebar: sidebarReducer,\r\n  usersPage: usersReducer,\r\n  auth: authReducer,\r\n  form: formReducer,\r\n  app: appReducer,\r\n});\r\n\r\ntype RootReducerType = typeof rootReducer;//(globalstate: AppStateType) => AppStateType\r\nexport type AppStateType = ReturnType<RootReducerType>//ReturnType утилита создает тип, состоящий из возвращаемого типа функции (самостоятельно определяет тип возвращаемый из <RootReducerType>) и присваиваем его AppStateType\r\n\r\n// let state: AppStateType\r\n// state.\r\n\r\n//создаем редаксовский стор с помощью функции createStore(cS мы отдаем закомбайненые редьюсеры)\r\n//добавляем промежуточный слой middleware thunk\r\n// let store = createStore(reducers, applyMiddleware(thunk));\r\nconst store = createStore(rootReducer, composeWithDevTools(applyMiddleware(thunk)));\r\n\r\nexport default store;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport store from './redux/redux-store';\r\nimport { HashRouter as Router } from 'react-router-dom'; //HashRouter применен для деплоя на gh-pages\r\n// import { BrowserRouter as Router, Route } from 'react-router-dom';//заменен на HashRouter\r\nimport { Provider } from 'react-redux';\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <Router>\r\n    {/* <Router basename={process.env.PUBLIC_URL}> */}\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>\r\n  </Router>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root'),\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Users_wrapper__3GS1A\",\"wrapper__item\":\"Users_wrapper__item__1cUQX\",\"userPhoto\":\"Users_userPhoto__22rSw\",\"userButton\":\"Users_userButton__1Rd_M\",\"pagination\":\"Users_pagination__9wTpd\",\"selectedPage\":\"Users_selectedPage__rTwP8\",\"preloader\":\"Users_preloader__13i_D\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"paginationBlockWrapper\":\"Paginator_paginationBlockWrapper__35ZIW\",\"paginationBlock\":\"Paginator_paginationBlock__3Lv8U\",\"pagination\":\"Paginator_pagination__1RdNg\",\"selectedPage\":\"Paginator_selectedPage__2m9br\",\"buttonPrev\":\"Paginator_buttonPrev__1vSfq\",\"buttonNext\":\"Paginator_buttonNext__22tii\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loginFormWrapper\":\"FormsControls_loginFormWrapper__QJkSz\",\"formControl\":\"FormsControls_formControl__ZczVY\",\"error\":\"FormsControls_error__-uRCD\",\"formSummaryError\":\"FormsControls_formSummaryError__2HC3s\"};","import styles from './FormsControls.module.css';\r\n\r\nexport const FormControl = ({ input, meta, child, ...props }) => {\r\n  const hasError = meta.touched && meta.error;\r\n\r\n  return (\r\n    <div className={styles.formControl + ' ' + (hasError ? styles.error : '')}>\r\n      <div>{props.children}</div>\r\n      {hasError && <span>{meta.error}</span>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const Textarea = (props) => {\r\n  const { input, meta, child, ...restProps } = props;\r\n\r\n  return (\r\n    <FormControl {...props}>\r\n      <textarea {...input} {...restProps} />\r\n    </FormControl>\r\n  );\r\n};\r\n\r\nexport const Input = (props) => {\r\n  const { input, meta, child, ...restProps } = props;\r\n\r\n  return (\r\n    <FormControl {...props}>\r\n      <input {...input} {...restProps} />\r\n    </FormControl>\r\n  );\r\n};\r\n\r\n// export const Textarea = ({ input, meta, ...props }) => {\r\n//   const hasError = meta.touched && meta.error;\r\n\r\n//   return (\r\n//     <div className={styles.formControl + ' ' + (hasError ? styles.error : '')}>\r\n//       <div>\r\n//         <textarea {...input} {...props} />\r\n//       </div>\r\n//       {hasError && <span>{meta.error}</span>}\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export const Input = ({ input, meta, ...props }) => {\r\n//   const hasError = meta.touched && meta.error;\r\n\r\n//   return (\r\n//     <div className={styles.formControl + ' ' + (hasError ? styles.error : '')}>\r\n//       <div>\r\n//         <input {...input} {...props} />\r\n//       </div>\r\n//       {hasError && <span>{meta.error}</span>}\r\n//     </div>\r\n//   );\r\n// };\r\n","export default __webpack_public_path__ + \"static/media/preloader.0703713f.svg\";","import React from 'react';\r\nimport styles from '../../Users/Users.module.css';\r\nimport preloader from '../../../assets/images/preloader.svg';\r\n\r\nconst Preloader = (props) => {\r\n  return (\r\n    <>\r\n      <img className={styles.preloader} src={preloader} alt='is loading...' />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Preloader;\r\n","export const required = (value) => {\r\n  if (value) return undefined;\r\n  return 'Field is required';\r\n};\r\n\r\nexport const maxLengthCreator = (maxLength) => (value) => {\r\n  if (value && value.length > maxLength) return `Max length is ${maxLength} symbols`;\r\n  return undefined;\r\n};\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"News_wrapper__3YHyz\",\"wrapper__item\":\"News_wrapper__item__1eIyu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Music_wrapper___hSbD\",\"wrapper__item\":\"Music_wrapper__item__267UF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Setings_wrapper__uTzoH\",\"wrapper__item\":\"Setings_wrapper__item__1F9W6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loginH1\":\"Login_loginH1__21Npf\",\"loginblock\":\"Login_loginblock__34CEy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__2IFrk\",\"login\":\"Header_login__6U0if\"};","import { profileAPI } from '../api/api';\r\nimport { stopSubmit } from 'redux-form';\r\nimport {PostType, ContactsType, PhotosType, ProfileType} from '../types/types'\r\nconst ADD_POST = 'WAY-OF-SAMURAI/PROFILE/ADD-POST'; //add redux-ducks\r\nconst SET_USERS_PROFILE = 'WAY-OF-SAMURAI/PROFILE/SET_USERS_PROFILE';\r\nconst SET_STATUS = 'WAY-OF-SAMURAI/PROFILE/SET_STATUS';\r\nconst SAVE_PHOTO_SUCCESS = 'WAY-OF-SAMURAI/PROFILE/SAVE_PHOTO_SUCCESS';\r\nconst DELETE_POST = 'WAY-OF-SAMURAI/PROFILE/DELETE_POST';\r\n\r\n\r\n//выносим типы в отдельный файл types и импортируем их по необходимости\r\n// type PostType = {\r\n//   id: number | null,\r\n//   message: string | null,\r\n//   likeCounter: number | null\r\n// }\r\n\r\n// type ContactsType = {\r\n//   facebook: string | null,\r\n//   website: string | null,\r\n//   vk: string | null,\r\n//   twitter: string | null,\r\n//   instagram: string | null,\r\n//   youtube: string | null,\r\n//   github: string | null,\r\n//   mainLink: string | null,\r\n// }\r\n\r\n// type PhotosType = {\r\n//   small: string | null,\r\n//   large: string | null,\r\n// }\r\n\r\n// type ProfileType = {\r\n//   aboutMe: string | null,\r\n//   contacts: ContactsType,\r\n//   lookingForAJob: boolean,\r\n//   lookingForAJobDescription: string | null,\r\n//   fullName: string | null,\r\n//   userId: number | null,\r\n//   photos: PhotosType,\r\n// }\r\n\r\nlet initialState = {\r\n  posts: [\r\n    { id: 1, message: 'Hi, how are you?', likeCounter: 15 },\r\n    { id: 2, message: 'My first react post', likeCounter: 25 },\r\n    { id: 3, message: 'Yo', likeCounter: 5 },\r\n  ] as Array<PostType>,\r\n  newPostText: '' as string | null,\r\n  profile: null as unknown as ProfileType,\r\n  status: '' as string | null,\r\n};\r\n\r\nexport type InitialStateType = typeof initialState\r\n\r\nconst profileReducer = (state: InitialStateType = initialState, action: AddPostActionCreatorActionType | SetUserProfileActionType | SetStatusActionType | SavePhotoSuccessActionType | DeletePostActionType): InitialStateType => {\r\n  switch (action.type) {\r\n    case ADD_POST:\r\n      return {\r\n        ...state,\r\n        posts: [...state.posts, { id: 4, message: action.newPostText, likeCounter: 0 }], //добавляем новый элемент в массив\r\n      };\r\n    case DELETE_POST:\r\n      return {\r\n        ...state,\r\n        posts: state.posts.filter((p) => p.id !== action.postId), //jest test\r\n      };\r\n    case SET_USERS_PROFILE:\r\n      return {\r\n        ...state,\r\n        profile: action.profile,\r\n      };\r\n    case SET_STATUS:\r\n      return {\r\n        ...state,\r\n        status: action.status,\r\n      };\r\n    case SAVE_PHOTO_SUCCESS:\r\n      return {\r\n        ...state,\r\n        profile: { ...state.profile, photos: action.photos },\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\n//ACTypes\r\ntype AddPostActionCreatorActionType = {\r\n  type: typeof ADD_POST,\r\n  newPostText: string | null\r\n}\r\ntype SetUserProfileActionType = {\r\n  type: typeof SET_USERS_PROFILE,\r\n  profile: ProfileType\r\n}\r\ntype SetStatusActionType = {\r\n  type: typeof SET_STATUS,\r\n  status: string | null\r\n}\r\ntype SavePhotoSuccessActionType = {\r\n  type: typeof SAVE_PHOTO_SUCCESS,\r\n  photos: PhotosType\r\n}\r\ntype DeletePostActionType = {\r\n  type: typeof DELETE_POST,\r\n  postId: number | null\r\n}\r\n\r\n// type ActionTypes = {\r\n//   action: AddPostActionCreatorActionType | SetUserProfileActionType | SetStatusActionType | SavePhotoSuccessActionType | DeletePostActionType\r\n// }\r\n\r\n\r\n//AC\r\n//создаем функции action creator, которая возвращает объект {action}, после чего переносим их в стейт\r\nexport const addPostActionCreator = (newPostText: string | null): AddPostActionCreatorActionType => ({ type: ADD_POST, newPostText });\r\n\r\nexport const setUserProfile = (profile: ProfileType): SetUserProfileActionType => ({ type: SET_USERS_PROFILE, profile });\r\n\r\nexport const setStatus = (status: string | null): SetStatusActionType => ({ type: SET_STATUS, status });\r\n\r\nexport const savePhotoSuccess = (photos: PhotosType): SavePhotoSuccessActionType => ({ type: SAVE_PHOTO_SUCCESS, photos });\r\n\r\nexport const deletePost = (postId: number | null): DeletePostActionType => ({ type: DELETE_POST, postId }); //jest test\r\n\r\n// export const saveProfileSuccess = (payload) => ({ type: SAVE_PROFILE_SUCCESS, payload });\r\n//TC\r\n\r\nexport const getUserProfile = (userId: number | null) => async (dispatch: any) => {\r\n  const data = await profileAPI.getProfile(userId);\r\n  dispatch(setUserProfile(data));\r\n}; //convert to async/await\r\n\r\n// export const getUserProfile = (userId) => {\r\n//   return (dispatch) => {\r\n//     usersAPI.getProfile(userId).then((data) => {\r\n//       dispatch(setUserProfile(data));\r\n//     });\r\n//   };\r\n// }; //with then\r\n\r\nexport const getStatus = (userId: number | null) => async (dispatch: any) => {\r\n  const data = await profileAPI.getStatus(userId);\r\n  dispatch(setStatus(data));\r\n}; //convert to async/await\r\n\r\nexport const updateStatus = (status: string | null) => async (dispatch: any) => {\r\n  try {\r\n    const data = await profileAPI.updateStatus(status);\r\n    if (data.resultCode === 0) {\r\n      dispatch(setStatus(status)); //после подверждения сервера сетаем себе статус\r\n    }\r\n  } catch (error) {\r\n    console.log('updateStatus error');\r\n  }\r\n}; //test try catch\r\n\r\nexport const savePhoto = (file: any) => async (dispatch: any) => {\r\n  const data = await profileAPI.savePhoto(file);\r\n  if (data.resultCode === 0) {\r\n    dispatch(savePhotoSuccess(data.data.photos)); //диспачим полученные фото\r\n  }\r\n};\r\n\r\n//TC отправка и получение данных профиля\r\nexport const saveProfile = (profile: ProfileType) => async (dispatch: any, getState: any) => {\r\n  const userId = getState().auth.userId; //в санку помимо диспача приходит стейт целиком, берем getState() и достаем из ветки auth нужный userId\r\n  // console.log(userId);\r\n  const data = await profileAPI.saveProfile(profile);\r\n  if (data.resultCode === 0) {\r\n    dispatch(getUserProfile(userId)); //диспачим id для получения новых данных с сервера после редатирования профиля\r\n  } else {\r\n    //встроенный экш редакс-форм, передаем в него имя формы(_error - или общую ошибку формы), вторым параметром передаем объект с проблемными полями, которые вызвали ошибку\r\n    let message = data.messages.length > 0 ? data.messages[0] : 'some error';\r\n    dispatch(stopSubmit('edit-profile', { _error: message })); //диспачим экшен с именем формы и объектом с общей ощибкой формы и причиной\r\n    return Promise.reject(message); //решение с отображением ошибки формы\r\n  }\r\n};\r\n\r\nexport default profileReducer;\r\n"],"sourceRoot":""}